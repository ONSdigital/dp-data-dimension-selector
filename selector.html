<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AF001EW Members of the Armed Forces by residence type by sex by age | Office for National Statistics</title>
    <link rel="stylesheet" type="text/css" href="https://www.ons.gov.uk/assets/css/main.css">
    <link rel="stylesheet" href="style.css">
    <style>

    </style>
</head>
<body>

<nav class="height--9 border-bottom--gallery-md">
    <div class="wrapper">
        <div class="header col-wrap">
            <div class="col col--lg-one-third col--md-one-third">
                <a href="/dp-data-dimension-selector">
                    <img class="main-logo" src="https://www.ons.gov.uk/assets/img/ons-logo.png" alt="Office for National Statistics">
                </a>
            </div>
        </div>
    </div>
</nav>

<div class="wrapper" style="height:600px;">

    <div class="col--lg-two-thirds">
        <h1>Choose dimensions</h1>


        <div style="position:relative">

            <ul class="list--neutral">
                <li class="margin-left--0 padding-bottom--2 padding-top--2 border-top--gallery-md border-bottom--gallery-md col-wrap width-lg--39">
                    <div class="col col--md-8 col--lg-8">
                        <strong>Age</strong>
                    </div>
                    <div class="col col--md-34 col--lg-26">Selected: <span class="selected-age">
                        <span class="selected__item">All categories: Age 16 and over</span><span class="selected__item">Age 16 to 24</span><span class="selected__item">Age 25 to 34</span><span class="selected__item">Age 35 to 49</span><span class="selected__item"> Age 50 and over</span></span>
                    </div>
                    <div class="col col--md-5 col--lg-5">
                        <a class="js-change-age float-right" data-modal="age">Change</a>
                    </div>
                </li>
                <li class="margin-left--0 padding-bottom--2 border-bottom--gallery-md col-wrap width-lg--39">
                <div class="col col--md-8 col--lg-8">
                    <strong>Sex</strong>
                </div>
                    <div class="col col--md-34 col--lg-26">
                        Selected: <span class="selected-sex"><span class="selected__item">All categories: Sex</span><span class="selected__item">Female</span><span class="selected__item">Male</span></span>
                    </div>
                    <div class="col col--md-5 col--lg-5">
                        <a class="js-change-sex float-right" data-modal="sex">Change</a>
                    </div>
                </li>
                <li class="margin-left--0 padding-bottom--2 border-bottom--gallery-md col-wrap width-lg--39">
                    <div class="col col--md-8 col--lg-8">
                        <strong>Residence Type</strong>
                    </div>
                    <div class="col col--md-34 col--lg-26">
                        Selected: <span class="selected-residence"><span class="selected__item">All categories: Residence type</span> <span class="selected__item">Lives in a household</span> <span class="selected__item">Lives in a communal establishment</span></span>
                    </div>
                    <div class="col col--md-5 col--lg-5">
                        <a class="js-change-residence float-right" data-modal="residence">Change</a>
                    </div>
                </li>
            </ul>

            <a class="btn btn--primary btn--thick btn--wide btn--big margin-top--4" href="download.html">Continue</a>

            <div class="modal options options__sex">
                <h2 class="margin-top-md--0">Select sex:</h2>
                <form id="options__sex-form">
                    <legend class="visuallyhidden">Choose a gender</legend>
                    <div class="checkbox">
                        <input id="options__sex-checkbox--total" data-dimension="sex" data-option="all" type="checkbox" name="sex" value="total">
                        <label for="options__sex-checkbox--total">All categories: sex</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__sex-checkbox--female" data-dimension="sex" data-option="female" type="checkbox" name="sex" value="female">
                        <label for="options__sex-checkbox--female">Female</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__sex-checkbox--male"  data-dimension="sex" data-option="male" type="checkbox" name="sex" value="male">
                        <label for="options__sex-checkbox--male">Male</label><br>
                    </div>
                    <!--<input type="submit" value="Submit">-->
                    <button id="options__sex-save" class="btn btn--primary btn--thick btn--wide btn--big margin-top--2">Save selection</button>
                    <button class="js-close-modal btn btn--secondary btn--thick btn--wide btn--big margin-top--2" data-modal="sex">Back</button>
                </form>
            </div>


            <div class="modal options options__age">
                <h2 class="margin-top-md--0">Select age:</h2>
                <form>
                    <legend class="visuallyhidden">Choose an age group</legend>
                    <div class="checkbox">
                        <input id="options__age-checkbox--total" data-dimension="age" data-option="all" type="checkbox" name="age" value="total">
                        <label for="options__age-checkbox--total">All categories: Age 16 and over</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__age-checkbox--age-1" data-dimension="age" data-option="age-16-to-24" type="checkbox" name="age" value="age-16-to-24">
                        <label for="options__age-checkbox--age-1">Age 16 to 24</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__age-checkbox--age-2" data-dimension="age" data-option="age-25-to-34" type="checkbox" name="age" value="age-25-to-34">
                        <label for="options__age-checkbox--age-2">Age 25 to 34</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__age-checkbox--age-3" data-dimension="age" data-option="age-35-to-49" type="checkbox" name="age" value="age-35-to-49">
                        <label for="options__age-checkbox--age-3">Age 35 to 49</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__age-checkbox--age-4" data-dimension="age" data-option="age-50-and-over" type="checkbox" name="age" value="age-50-and-over">
                        <label for="options__age-checkbox--age-4">Age 50 and over</label>
                    </div>
                    <button id="options__age-save" class="btn btn--primary btn--thick btn--wide btn--big margin-top--2 ">Save selection</button>
                    <button class="js-close-modal btn btn--secondary btn--thick btn--wide btn--big margin-top--2" data-modal="age">Back</button>
                </form>
            </div>

            <div class="modal options options__residence">
                <h2 class="margin-top-md--0">Select residence type:</h2>
                <form id="options__residence-form">
                    <legend class="visuallyhidden">Choose a residence type</legend>
                    <div class="checkbox">
                        <input id="options__residence-checkbox--total" data-dimension="residence" data-option="all" type="checkbox" name="residence" value="total">
                        <label for="options__residence-checkbox--total">All categories: Residence Type</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__residence-checkbox--household" data-dimension="residence" data-option="lives-in-a-household" type="checkbox" name="residence" value="household">
                        <label for="options__residence-checkbox--household">Lives in a household</label>
                    </div>
                    <div class="checkbox">
                        <input id="options__residence-checkbox--communal" data-dimension="residence" data-option="lives-in-a-communal-establishment" type="checkbox" name="residence" value="communal">
                        <label for="options__residence-checkbox--communal">Lives in a communal establishment</label>
                    </div>
                    <button id="options__residence-save" class="btn btn--primary btn--thick btn--wide btn--big margin-top--2">Save selection</button>
                    <button class="js-close-modal btn btn--secondary btn--thick btn--wide btn--big margin-top--2" data-modal="residence">Back</button>
                </form>
            </div>
        </div>
    </div>
</div>

<footer class="print--hide">
    <h2 class="visuallyhidden">Footer links</h2>
    <div class="footer">
        <div class="wrapper">
            <div class="footer-license">
                <img class="footer-license__img" alt="OGL" width="60" src="https://www.ons.gov.uk/img/ogl.png">
                <p class="footer-license__text margin-left-sm--0">
                    All content is available under the <a class="icon--hide" href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/">Open Government Licence v3.0</a> <span class="icon icon-external--light-small"></span>, except where otherwise stated
                </p>
            </div>
        </div>
    </div>
</footer>


<script src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous">
</script>

<script>

    var selected = {
        age: {
            "all": true,
            "age-16-and-over": true,
            "age-16-to-24": true,
            "age-25-to-34": true,
            "age-35-to-49": true,
            "age-50-and-over": true
        },
        sex: {
            "male": true,
            "female": true,
            "all": true
        },
        residence: {
            "all": true,
            "lives-in-a-household": true,
            "lives-in-a-communal-establishment": true
        }
    };

    $('.js-change-sex').click( function() {

        var modalName = $(this).data('modal');
        setCheckBoxesInModal(modalName);
        openModal(modalName);

        $('#options__sex-save').click(function(e) {
            e.preventDefault();

            $('.selected-' + modalName).empty();

            getCheckBoxesInModal(modalName);

            $('#options__sex-save').off();
            $('.options__sex').hide();
            console.log(selected);
        });

    });

    $('.js-change-age').click( function() {

        var modalName = $(this).data('modal');
        setCheckBoxesInModal(modalName);
        openModal(modalName);

        $('#options__age-save').click(function(e) {
            e.preventDefault();

            $('.selected-' + modalName).empty();

            getCheckBoxesInModal(modalName);

            $('#options__age-save').off();
            $('.options__age').hide();
        });

    });

    $('.js-change-residence').click( function() {

        var modalName = $(this).data('modal');
        setCheckBoxesInModal(modalName);
        openModal(modalName);

        $('#options__residence-save').click(function(e) {
            e.preventDefault();

            $('.selected-' + modalName).empty();

            getCheckBoxesInModal(modalName);

            $('#options__residence-save').off();
            $('.options__residence').hide();
        });

    });

    $('.js-close-modal').click(function(e) {
        e.preventDefault();
        var modalName = $(this).data('modal');
        $('.options__' + modalName).hide();
    });

    function openModal(modalClass) {
        $('.options__' + modalClass).show();
    }

    function setCheckBoxesInModal(modalClass) {
        $('.options__' + modalClass).find('input').each( function() {
            var option = $(this).data('option');
            var dimension = $(this).data('dimension');
            if (selected[dimension][option]) {
                $(this).prop( "checked", true )
            } else {
                $(this).prop( "checked", false )
            }

        });
    }

    function getCheckBoxesInModal(modalClass) {
        $('.options__' + modalClass).find('input').each( function() {
            var option = $(this).data('option');
            var dimension = $(this).data('dimension');
            var labelText = $(this).next().text();
            var selectedList = $('.selected-' + modalClass);
            if ($(this).prop( "checked" )) {
                selected[dimension][option] = true;
                selectedList.append(wrapInSpan(labelText));
            } else {
                selected[dimension][option] = false;
            }

        });
    }

    function wrapInSpan(text) {
        return $('<span class="selected__item">' + text + '</span>');
    }

</script>

</body>
</html>